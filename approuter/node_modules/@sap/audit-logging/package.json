{
  "_args": [
    [
      "@sap/audit-logging@^1.0.5",
      "/Users/i048564/Documents/Eclipse/neon/sample.hello/approuter/node_modules/@sap/approuter"
    ]
  ],
  "_from": "@sap/audit-logging@>=1.0.5 <2.0.0",
  "_id": "@sap/audit-logging@1.0.5",
  "_inCache": true,
  "_installable": true,
  "_location": "/@sap/audit-logging",
  "_nodeVersion": "6.9.2",
  "_npmUser": {
    "email": "do.not.reply@sap.com",
    "name": "https-support.sap.com"
  },
  "_npmVersion": "3.10.9",
  "_phantomChildren": {},
  "_requested": {
    "name": "@sap/audit-logging",
    "raw": "@sap/audit-logging@^1.0.5",
    "rawSpec": "^1.0.5",
    "scope": "@sap",
    "spec": ">=1.0.5 <2.0.0",
    "type": "range"
  },
  "_requiredBy": [
    "/@sap/approuter"
  ],
  "_resolved": "https://npm.sap.com/@sap/audit-logging/-/audit-logging-1.0.5.tgz",
  "_shasum": "f5be9621c421e0598725a92365777a507db700aa",
  "_shrinkwrap": null,
  "_spec": "@sap/audit-logging@^1.0.5",
  "_where": "/Users/i048564/Documents/Eclipse/neon/sample.hello/approuter/node_modules/@sap/approuter",
  "dependencies": {
    "moment": "2.15.2",
    "winston": "1.1.2"
  },
  "description": "Provides audit logging functionalities for Node.js applications",
  "devDependencies": {
    "chai": "3.5.0",
    "eslint": "3.2.2",
    "filter-node-package": "^2.0.0",
    "istanbul": "0.4.4",
    "mocha": "3.0.2",
    "node-style": "^2.0.0",
    "proxyquire": "1.7.10",
    "sinon": "1.17.5"
  },
  "dist": {
    "shasum": "f5be9621c421e0598725a92365777a507db700aa",
    "tarball": "https://npm.sap.com/@sap/audit-logging/-/audit-logging-1.0.5.tgz"
  },
  "engines": {
    "node": "^0.12.7 || ^4.4.0 || ^6.0.0"
  },
  "license": "SEE LICENSE IN developer-license-3.1.txt",
  "main": "index.js",
  "maintainers": [
    {
      "name": "https-support.sap.com",
      "email": "do.not.reply@sap.com"
    }
  ],
  "name": "@sap/audit-logging",
  "optionalDependencies": {},
  "readme": "# @sap/audit-logging\n\nProvides audit logging functionalities for Node.js applications.\n\n\n## Overview\n\nAudit logging is about writing entries in a specific format to a log storage. Subject to audit logging are events of significant importance.\nFor example, security events which may impact the confidentiality, the integrity or the availability of a system.\nAnother example of such an event would be access to sensitive personal data (both reading and altering) like bank accounts, political opinion,\nhealth status etc.\n\nWhile the consumer of ordinary logs is a system administrator who would like to keep track of the state of a system,\naudit logs are read by an auditor. There are legal requirements (in some countries stricter than in others) regarding audit logging.\n\nIn general the events that are supposed to be audit logged can be gouped in 3 main categories:\n- changes to system configurations (which may have significant effect on the system itself)\n- access to sensitive data (related to data privacy)\n- general security events (like starting/stopping a system, failed authorization checks etc.)\n\n\n### General audit logging principles\n\n- All attempts to perform an action in a system should be audit logged no matter if they have been successful or not.\n- Audit log entries should be consistent with the state of the system. If, for example, the writing of the audit log entry fails,\nbut the changes to system critical parameters have been applied, then those changes should be reverted. Best practice is to wait for\nthe callback of the logger before continuing with the execution of other code.\n- Especially important is which user (or other agent) has triggered the corresponding event that is being audit logged.\nFor most of the cases the library will validate that such a field is provided in the message.\n- All audit log entries should be in English. Numbers should be converted to strings with English locale.\nAll time fields should be in UTC time in order to avoid timezone and day light saving time issues.\n- Passwords should never be audit logged.\n\n\n## Message format\n\nAn audit log entry may contain the following parts:\n\n![Audit log message format](diagram.png \"Audit log message format diagram\")\n\n- Verb - contains the action that was performed, e.g. _create_, _read_, _update_, _delete_\nand the UTC time the message has been created at.\n\n- Object - contains the information about the object the action has been performed on. The _objectID_ is a mandatory field.\nIt is a unique indetifier of the object (e.g., primary key for an entry in a database). _objectName_ is the display name\nof the object. The library treats this field as optional. The object part may also contain the attributes of the object on which the action has been performed.\nIf none are provided, then it should be considered that the action has been performed over the whole object. For example, if the action is _read_ and the object is _user with id 123_,\nand if the attribute _birthday_ is provided, then it is considered that only this attribute of the user has been read.\nIf no attributes are provided, then it is assumed that all the user data has been read.\n\n- Custom - contains name-value pairs which add additional context to the audit log message. For example, the user who performed the action,\nthe category of the message, access channel from which the operation has been triggered etc. Application developers can add their own custom attributes as well.\n\n\n## API\n\nThe library provides an API for writing data access event entries of type _create_, _read_, _update_, _delete_.\nThis general mechanism can be used for entries for any kind of data and can be further classified (e.g. as system configuration)\nvia a _category_ which can be specified as a custom attribute.\n\nThe library also provides an API for general security messages.\n\n\n### Importing the library\n\n```js\nvar auditLog = require('@sap/audit-logging');\n```\n\nThe `auditLog` object contains the following functions:\n\nFunction        | Purpose\n--------------- | -------\ncreate          | Used to create an entry for a _create_ operation.\nread            | Used to create an entry for a _read_ operation.\nupdate          | Used to create an entry for an _update_ operation.\ndelete          | Used to create an entry for a _delete_ operation.\nsecurityMessage | Used to create a general security audit log message.\n\n\n### Data access messages\n\nSuch messages are logged when a specific action (_create_, _read_, _update_ or _delete_) is performed on some data.\n\n- Basic usage\n\nLet's suppose we need to create an entry for a _read_ operation over user data. We can achieve that with the following code:\n\n```js\nauditLog.read('123', 'John Doe')\n  .attribute('First name', 'John')\n  .attribute('Last name', 'Doe')\n  .attribute('Birth date')\n  .by('John Doe')\n```\n\nThe `attribute` method sets object attributes. If it is considered that the birth date is too sensitive to be present in the audit logs, the value of the attribute can be left unspecified.\nIf no attributes are specified, it is assumed that all user data has been read.\n\nIt is important to specify which is the driver of the action. The library will enforce it for all the functions of the `auditLog` object named after an action.\nSetting it can be achieved with the `by` method. In this case John Doe has read his own user info. The entry that will be produced would look like the following:\n\n> verb={\"action\":\"read\",\"timestamp\":\"2016-03-24T14:07:05+00:00\"},object={\"objectID\":\"123\",\"objectName\":\"John Doe\",\"objectAttributes\":{\"First name\":\"John\",\"Last name\":\"Doe\",\"Birth date\":\"n/a\"}},custom={\"driver of action\":\"John Doe\"}\n\n_n/a_ is used in case object attribute value is not specified.\n\n\nIn that example we set the custom attribute 'driver of action'. This is one of the [predefined custom attributes](#predefined-custom-attributes) for which there is a dedicated method.\nIt is also possible to set your own custom attribute, like that:\n\n```js\nauditLog.read('123', 'John Doe')\n  .attribute('First name', 'John')\n  .attribute('Last name', 'Doe')\n  .attribute('Birth date')\n  .by('John Doe')\n  .customAttribute('my custom attribute', 'my value')\n```\n\nNow the message would look like:\n\n> verb={\"action\":\"read\",\"timestamp\":\"2016-03-24T14:12:13+00:00\"},object={\"objectID\":\"123\",\"objectName\":\"John Doe\",\"objectAttributes\":{\"First name\":\"John\",\"Last name\":\"Doe\",\"Birth date\":\"n/a\"}},custom={\"driver of action\":\"John Doe\",\"my custom attribute\":\"my value\"}\n\n- Configuration related messages\n\nIn this case the `category` method can be used (this is also one of the [predefined custom attributes](#predefined-custom-attributes)) to add more context information to the message:\n\n```js\nauditLog.read('001122', 'application configuration')\n  .category('configuration')\n  .attribute('session timeout', 25)\n  .by('Application Admin')\n```\n\nThe resulting message would look like:\n\n> verb={\"action\":\"read\",\"timestamp\":\"2016-03-24T18:11:13+00:00\"},object={\"objectID\":\"001122\",\"objectName\":\"application configuration\",\"objectAttributes\":{\"session timeout\":\"25\"}},custom={\"category\":\"configuration\",\"driver of action\":\"Application Admin\"}\n\n- Messages for _update_ operations\n\nWhen creating an entry for an _update_ action it is possible to specify the old and the new value of an object attribute:\n\n```js\nauditLog.update('001122', 'application configuration')\n  .category('configuration')\n  .attribute('session timeout', 25, 40)\n  .by('Application Admin')\n```\n\nThe entry would look like this:\n\n> verb={\"action\":\"update\",\"timestamp\":\"2016-03-24T16:19:27+00:00\"},object={\"objectID\":\"001122\",\"objectName\":\"application configuration\",\"objectAttributes\":{\"session timeout\":{\"oldValue\":\"25\",\"newValue\":\"40\"}}},custom={\"category\":\"configuration\",\"driver of action\":\"Application Admin\"}\n\n_Note_: the library throws an error if specifying an old value and a new value of an attribute for an action different from _update_.\n\n- Unsuccessful attempts to perform an action\n\nIt is also important to create entries for unsuccessful attempts to perform an action. Here is an example how to do so:\n\n```js\nauditLog.delete('123', 'John Doe')\n  .by('An unauthorized user')\n  .successful(false)\n```\n\nThis example shows how to build an audit log message for the case in which the user _An unauthorized user_ has tried to delete all the data for a _user with id 123 (John Doe)_,\nbut the operation has not been successful. Unsuccessful operations are marked as _attempts_ in the entries and in this example the action would be '_delete-attempt_' instead of just '_delete_'.\nBy default operations are marked as successful. To change that use the `successful` method. The example entry would look like this:\n\n> verb={\"action\":\"delete-attempt\",\"timestamp\":\"2016-03-24T16:38:31+00:00\"},object={\"objectID\":\"123\",\"objectName\":\"John Doe\"},custom={\"driver of action\":\"An unauthorized user\"}\n\n### General security messages\n\nThose can be created like this:\n\n```js\nauditLog.securityMessage('%d unsuccessful login attempts', 3).by('John Doe')\n  .customAttribute('user status', 'blocked')\n```\n\nThe entry would look like:\n\n> verb={\"action\":null,\"timestamp\":\"2016-03-24T17:13:10+00:00\"},custom={\"message\":\"3 unsuccessful login attempts\",\"driver of action\":\"John Doe\",\"user status\":\"blocked\"}\n\nNote that in this case the action is 'null' and there is no 'object' part in the message.\nIn the `securityMessage` function you may use the same string interpolation mechanism as with [util.format](https://nodejs.org/api/util.html#util_util_format_format).\n\n#### Predefined custom attributes\n\nThe custom part of an audit log message contains name-value pairs which can be used to attach additional context of the message.\nThere are several methods (avaialble for both data access messages and general security messages) which can be used to set some commonly used custom properties:\n\nMethod          | Custom property name | Purpose\n--------------- | -------------------- | --------\nby              | driver of action     | States which is the agent that triggered the operation.\naccessChannel   | access channel       | States how the data (or the system itself) is being accessed (e.g. RFC, Web services, UI).\nexternalIP      | external IP          | States the IP of the machine that contacts the system.\ncategory        | category             | Adds a category to the message.\n\n### Logging a message\n\nUse the `log` method to actually log a message. It takes one argument, a callback function. Be aware that the state of the audit logs should be consistent\nwith the state of the system. Make sure you handle errors from the audit log writer properly. Best practice is to wait for the logging to finish before executing other code.\n\n```js\nauditLog.create('001122', 'some configuration')\n  .category('configuration')\n  .by('Application Admin')\n  .log(function (err) {\n    // Place all of the remaining logic here\n  });\n```\n\nThe same function (`log`) is used for general security messages as well.\n\n## Logs storage\n\nThere are several possibilities for storage. The following two environment variables (set by the XS Advanced OnPremise Runtime) are taken into account:\n\n- _XS_AUDIT_LOG_FILE_ - which holds the path to an audit log file\n- _XS_AUDIT_TO_SYSLOG_ - which holds a boolean value taken from the audit log setting of the xs-controller\n\n_XS_AUDIT_TO_SYSLOG_ has the highest priority. If it is set to 'true', then the library will sent the audit log entries to Syslog (or Event Log on Windows).\nTo achieve that the `sap_syslog` module (part of SAP Node.js) should be present in the currently used Node.js runtime, otherwise an error is thrown.\n\nIf _XS_AUDIT_LOG_FILE_ is provided and _XS_AUDIT_TO_SYSLOG_ is set to 'false' (or is missing), then the entries will be stored in the _XS_AUDIT_LOG_FILE_.\n\nIf those environment variables are not set (e.g. in Cloud Foundry scenarios or local development), then the entries will be sent to the console.\nThe console will be used as well if _XS_AUDIT_TO_SYSLOG_ is set to 'false' and there is no _XS_AUDIT_LOG_FILE_ provided.\n\nIn case Syslog is used as a storage (or Event Log on Windows): If your application is running on the XS Advanced OnPremise Runtime (or Cloud Foundry)\nthe component name used is taken from the environment (the _application_name_ property in the _VCAP_APPLICATION_ environment variable).\nIf running the application locally, then the entries will be logged with '_sap-nodejs-audit-logging_' as a component name.\n",
  "readmeFilename": "README.md",
  "repository": {},
  "scripts": {},
  "version": "1.0.5"
}
